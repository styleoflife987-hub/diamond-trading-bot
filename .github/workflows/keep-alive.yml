name: Keep Render Alive

on:
  schedule:
    - cron: '*/5 * * * *'  # Every 5 minutes
    - cron: '*/10 * * * *'  # Backup every 10 minutes
  workflow_dispatch:
  push:
    branches: [ main ]  # Test on push

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Ping Render App Health Endpoint
        run: |
          curl -I https://telegram-bot-6iil.onrender.com/health
          curl -I https://telegram-bot-6iil.onrender.com/ping
      
      - name: Verify Bot Status
        run: |
          curl -s https://telegram-bot-6iil.onrender.com/status | grep -q "healthy" && echo "✅ Bot is healthy" || echo "⚠️ Bot may be unhealthy"
      
      - name: Notify on Failure (Optional)
        if: failure()
        run: |
          echo "::warning::Keep-alive ping failed! Check your Render app."
